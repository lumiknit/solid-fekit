import{use as e,spread as t,mergeProps as r,insert as n,template as o,createComponent as s,effect as l,setAttribute as a,delegateEvents as c,className as i,addEventListener as u,Dynamic as d}from"solid-js/web";import{createSignal as h,createEffect as p,untrack as g,Show as m,For as f,mergeProps as v,splitProps as w}from"solid-js";import{createStore as b}from"solid-js/store";var y=o("<button>");const x=o=>{const s=()=>{const e={...o};for(const t of["ref","children","class","color","outline","small","disabled"])delete e[t];return e};return l=y(),"function"==typeof(a=o.ref)?e(a,l):o.ref=l,t(l,r(s,{get class(){return`no-user-select btn btn-${o.outline?"ol-":""}${o.color||"secondary"} ${o.small?"btn-sm":""} ${o.class??""}`}}),!1,!0),n(l,(()=>o.children)),l;var l,a};var S=o('<svg stroke-width=0.15 viewBox="0 0 1 1">// Check shape<path d="\n\t\t\t\t\t\t\tM 0.2 0.5\n\t\t\t\t\t\t\tL 0.45 0.75\n\t\t\t\t\t\t\tL 0.9 0.25\n\t\t\t\t\t\t">'),k=o('<label class=checkbox><div class="wh-1 checkbox-box no-user-select cursor-pointer"></div><input type=checkbox name=checkbox>');var C=o("<div class=dropdown><div>");c(["click"]);var $=o("<div>");const I=e=>{return t=$(),u(t,"drop",e.onDrop),u(t,"click",e.onClick,!0),n(t,(()=>e.children)),l((()=>i(t,`input-group ${e.class??""}`))),t;var t};c(["click"]);var M=o("<input type=text>");const T=t=>{return r=M(),"function"==typeof(n=t.ref)?e(n,r):t.ref=r,l((e=>{var n=`form-control ${t.class??""}`,o=t.placeholder;return n!==e.e&&i(r,e.e=n),o!==e.t&&a(r,"placeholder",e.t=o),e}),{e:void 0,t:void 0}),r;var r,n};var _=o("<input type=file class=d-none>");var D=o("<div>");var B=o("<span>");var P=Object.freeze({__proto__:null,Button:x,Checkbox:t=>{const[r,o]=h(t.value),c=e=>{const r=e.target;console.log(r.checked),o(r.checked),t.onChange?.(r.checked)};return p((()=>{const e=g(r);t.value!==e&&o(t.value)})),(()=>{var o=k(),i=o.firstChild,u=i.nextSibling;n(i,s(m,{get when(){return r()},get children(){var e=S();return l((()=>a(e,"class",`stroke-${t.color||"primary"}`))),e}})),u.addEventListener("change",c);var d=t.ref;return"function"==typeof d?e(d,u):t.ref=u,n(o,(()=>t.children),null),l((()=>u.checked=t.value)),o})()},DropdownButton:function(e){const[t,o]=h(!1),a=()=>{const t={...e};return delete t.label,delete t.children,t};return c=C(),u=c.firstChild,n(c,s(x,r(a,{onClick:()=>o((e=>!e)),get children(){return e.label(e.labelProps)}})),u),u.$$click=()=>{o(!1)},n(u,(()=>e.children)),l((()=>i(u,"dropdown-menu shadow-2 "+(t()?"visible":"hidden")))),c;var c,u},InputFile:t=>{let r,n;const o=e=>{n=e,"function"==typeof t.ref&&t.ref(e)},l=e=>{t.onFiles&&t.onFiles(e.target.files),r.value=n.value};return s(I,{get class(){return t.class},onDrop:e=>{e.preventDefault(),e.stopPropagation(),t.onFiles&&t.onFiles(e.dataTransfer.files)},get children(){return[s(T,{class:"flex-1",ref(e){"function"==typeof r?r(e):r=e},get placeholder(){return t.placeholder},onClick:()=>{n?.click()}}),(a=_(),a.addEventListener("change",l),e(o,a),a),s(x,{get color(){return t.color},onClick:()=>{n?.click()},children:"..."})];var a}})},InputGroup:I,InputLabel:e=>{return t=D(),n(t,(()=>e.children)),l((()=>i(t,`form-control btn-${e.outline?"ol-":""}${e.color} ${e.class??""}`))),t;var t},InputText:T,RadioButtons:function(e){const t=e.buttons.findIndex((t=>t.value===e.initialValue)),[r,n]=h(t);return s(I,{get class(){return e.class},get children(){return s(f,{get each(){return e.buttons},children:(t,o)=>s(x,{get color(){return t.color},get outline(){return r()!==o()},get class(){return t.class},onClick:()=>(t=>{n(t),e.onChange?.(e.buttons[t].value)})(o()),get children(){return t.label}})})}})},Spinner:e=>{return n=B(),t(n,r(e,{get class(){return`wh-1 spinner border-${e.color||"primary"} ${e.class||""}`}}),!1,!1),n;var n}});class R{constructor(e,t,r){this.db=e,this.store=t,this.mode=r}async wrap(e){return new Promise(((t,r)=>{const n=e(this.store);n.onsuccess=()=>t(n.result),n.onerror=()=>r(n.error)}))}async add(e,t){return this.wrap((r=>r.add(e,t)))}async get(e){return this.wrap((t=>t.get(e)))}async getAll(){return this.wrap((e=>e.getAll()))}async getAllKeys(){return this.wrap((e=>e.getAllKeys()))}async getKey(e){return this.wrap((t=>t.getKey(e)))}async clear(){return this.wrap((e=>e.clear()))}async count(){return this.wrap((e=>e.count()))}async delete(e){return this.wrap((t=>t.delete(e)))}async put(e,t){return this.wrap((r=>r.put(e,t)))}async openCursor(e,t){return this.wrap((r=>r.openCursor(e,t)))}async openKeyCursor(e,t){return this.wrap((r=>r.openKeyCursor(e,t)))}index(e){return this.store.index(e)}createIndex(e,t,r){return this.store.createIndex(e,t,r)}deleteIndex(e){this.store.deleteIndex(e)}}const j=(e,t)=>new Promise(((r,n)=>{const o=window.indexedDB.open(e);o.onsuccess=()=>r(o.result),o.onerror=()=>n(o.error),o.onupgradeneeded=e=>{const s=o.result;t?t(s,e).then((()=>r(s))).catch(n):n(new Error("Upgrade needed, but no handler provided"))}})),A=(e,t,r="readonly",n)=>new Promise(((o,s)=>{const l=e.transaction(t,r);n&&(l.oncomplete=n),l.onerror=()=>s(l.error);const a=[];for(const e of t)a.push(l.objectStore(e));o(a)}));var O=Object.freeze({__proto__:null,AsyncIDBStore:R,openIDB:j,openIDBStore:async(e,t,r={})=>{const n=await j(e,r.handleUpgrade),o=r.mode||"readonly";return(await A(n,t,o,r.onComplete)).map((e=>new R(n,e,o)))},openStore:A});const E=()=>navigator.clipboard;let F,L;if(void 0!==E()&&void 0!==E().readText&&void 0!==E().writeText)F=E().writeText,L=E().readText;else{let e="";F=t=>{e=t},L=async()=>e}const z=(e,t,r)=>{let n;return(r-=Math.floor(r))<.5?(n=t,r<1/6&&(n=e+6*(t-e)*r)):(n=e,r<2/3&&(n=e+(t-e)*(2/3-r)*6)),Math.round(255*n)},G=e=>Math.random().toString(36).slice(e),K=()=>G(7),U=()=>{const e=new Date;return Math.round(e.getTime()/1e3+60*e.getTimezoneOffset()).toString(36)},H=new Set([".",""]),N=(e,t)=>{const r=(t||[]).concat(e.split("/")),n=""===r[0];if(r.length<=1)return["."];const o=r.filter((e=>!H.has(e)));for(let e=0;e<o.length;e++)".."===o[e]&&(o.splice(e-1,2),e-=2);return n&&o.unshift(""),o},V=e=>e.join("/"),Y=e=>{const t=N(e);return t[t.length-1]};var q=Object.freeze({__proto__:null,CURRENT_SEGMENTS:H,HSL2RGB:(e,t,r)=>{if(0===t)return[r,r,r];const n=r<.5?r*(1+t):r+t-r*t,o=2*r-n;return[z(o,n,e+1/3),z(o,n,e),z(o,n,e-1/3)]},PATH_SEPARATOR:"/",RGB2GRAY:(e,t,r)=>.299*e+.587*t+.114*r,RGB2HSL:(e,t,r)=>{e/=255,t/=255,r/=255;const n=Math.max(e,t,r),o=Math.min(e,t,r),s=n+o,l=n-o;if(n===o)return[0,0,n];const a=s>1?l/(2-2*s):l/s;switch(n){case e:return[((t-r)/l+(t<r?6:0))/6,a,s/2];case t:return[((r-e)/l+2)/6,a,s/2];default:return[((e-t)/l+4)/6,a,s/2]}},extractDirectory:e=>{const t=N(e);return V(t.slice(0,-1))},extractFileExtension:e=>{const t=Y(e),r=t.lastIndexOf(".");return-1===r?"":t.slice(r+1)},extractFilename:Y,genID:()=>`${U()}-${K()}`,hslStyle:(e,t,r)=>`hsl(${e}, ${100*t}%, ${100*r}%)`,incIndexToFilename:e=>{const t=N(e),r=Y(e);let n=r.lastIndexOf(".");n<0&&(n=r.length);const o=r.slice(0,n),s=r.slice(n),l=o.match(/([0-9]+)([^0-9]*)$/);if(!l)return e;const a=parseInt(l[1])+1,c=o.slice(0,l.index)+a+l[2]+s;return t[t.length-1]=c,V(t)},isAbsolute:e=>""===e[0],joinPath:V,get loadString(){return L},longRandom:()=>G(2)+G(2),parsePath:N,get saveString(){return F},shortRandom:K,sleep:e=>new Promise((t=>setTimeout(t,e))),timeString:U,zeroed:(e,t)=>"0".repeat(t-e.length)+e});const[J,Q]=b({nextID:0,modals:[],transitionMS:300}),W=e=>{const t=J.modals.find((t=>t.id===e));if(!t)return;clearTimeout(t.timeout);const r=t.callbacks.onClose;r&&!r()||(t.setShown(!1),t.timeout=window.setTimeout((()=>{t.callbacks.onUnmount?.(),Q("modals",(t=>t.filter((t=>t.id!==e))))}),J.transitionMS))};var X=o("<div>");var Z=Object.freeze({__proto__:null,ModalContainer:e=>{const o=v({hiddenClass:"hidden",shownClass:"shown",transitionMS:300},e),[a,c]=w(o,["class","hiddenClass","shownClass","transitionMS"]);p((()=>{(e=>{"number"==typeof e.transitionMS&&Q("transitionMS",e.transitionMS)})(o)}));const u=e=>{e.target===e.currentTarget&&J.modals.length>0&&W(J.modals[J.modals.length-1].id)};return s(m,{get when(){return J.modals.length>0},get children(){var e=X();return t(e,r(c,{get class(){return`modal-container ${a.class}`},onClick:u}),!1,!0),n(e,s(f,{get each(){return J.modals},children:e=>{return t=X(),n(t,s(d,r({get component(){return e.component},close:()=>W(J.modals[J.modals.length-1].id)},(()=>e.props)))),l((()=>i(t,`modal-item ${e.shown()?a.shownClass:a.hiddenClass}`))),t;var t}})),e}})},closeModal:W,openModal:(e,t,r={})=>{const n=(()=>{const e=J.nextID.toString(36);return Q("nextID",(e=>e+1)),e})(),[o,s]=h(!1),l=window.setTimeout((()=>{r.onOpened?.()}),J.transitionMS),a={id:n,shown:o,setShown:s,timeout:l,component:e,props:t,callbacks:r};return Q("modals",(e=>[...e,a])),setTimeout((()=>{r.onMount?.(),s(!0)})),n}});export{P as block,q as common,O as idb,Z as modal};
//# sourceMappingURL=index.js.map
